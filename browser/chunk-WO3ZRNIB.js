import{a as A}from"./chunk-7GZO4EV5.js";import"./chunk-TNF5RKJF.js";import{a as M}from"./chunk-F6LDSNR5.js";import{a as N,c as D,g as U,o as q}from"./chunk-TGO5R4BE.js";import{h as E,i as I,k as w}from"./chunk-YSL4L367.js";import{Fb as o,Gb as v,Ib as T,Jb as S,Kb as k,Na as m,Nb as V,Ob as F,Ta as h,Xa as x,ab as f,d as g,ha as b,ia as p,kb as d,ob as a,pb as n,qb as C,r as y,tb as _,xb as u,yb as c}from"./chunk-RCD2EZCC.js";function J(r,i){if(r&1){let e=_();a(0,"button",7),u("click",function(){b(e);let s=c();return p(s.Crudd("C"))}),o(1,"Nuevo"),n()}}function L(r,i){if(r&1){let e=_();a(0,"button",10),u("click",function(){b(e);let s=c().$implicit,l=c();return p(l.Crudd("U",s))}),C(1,"i",11),n()}}function j(r,i){if(r&1){let e=_();a(0,"button",12),u("click",function(){b(e);let s=c().$implicit,l=c();return p(l.Crudd("D",s))}),C(1,"i",13),n()}}function B(r,i){if(r&1&&(a(0,"tr")(1,"td"),f(2,L,2,0,"button",8)(3,j,2,0,"button",9),n(),a(4,"td"),o(5),n(),a(6,"td"),o(7),V(8,"date"),n(),a(9,"td"),o(10),n()()),r&2){let e=i.$implicit,t=c();m(2),d("ngIf",t.roles.includes("admin")||t.roles.includes("Validador")),m(),d("ngIf",t.roles.includes("admin")),m(2),v(e.nombre),m(2),v(F(8,5,e.fechacreacion,"yyyy-MM-dd HH:mm:ss")),m(3),v(e.fkemailusuario)}}var O=class r{constructor(i,e){this.api=i;this.modal=e}data;Tabla="variable";rolesJson=sessionStorage.getItem("roles");roles=[];filtroTexto="";dataFiltrada=[];ngOnInit(){this.TraerTabla(),this.roles=this.rolesJson?JSON.parse(this.rolesJson):[]}filtrarTabla(){let i=this.filtroTexto.toLowerCase();this.dataFiltrada=this.data.filter(e=>Object.values(e).some(t=>t?.toString().toLowerCase().includes(i)))}TraerTabla(){return g(this,null,function*(){try{this.data=yield y(this.api.TraerTabla(this.Tabla)),this.dataFiltrada=this.data}catch(i){console.error("Error al obtener la tabla:",i)}})}Crudd(i,e){let t;i==="C"?t={fields:[{name:"nombre",label:"Nombre",type:"text",value:"",validators:["required"]},{name:"fechacreacion",label:"Fecha de Creaci\xF3n",type:"datetime-local",value:"",disabled:!0},{name:"fkemailusuario",label:"Usuario",type:"email",value:"",fk:!0,strTable:"usuario",validators:["required"]}]}:i==="U"?t={fields:[{name:"nombre",label:"Nombre",type:"text",value:e.nombre,validators:["required"]},{name:"fechacreacion",label:"Fecha de Creaci\xF3n",type:"datetime-local",value:e.fechacreacion,disabled:!0},{name:"fkemailusuario",label:"Usuario",type:"email",value:e.fkemailusuario,fk:!0,strTable:"usuario",validators:["required"]}]}:i==="D"&&(t={fields:[{name:"nombre",label:"Nombre",type:"text",value:e.nombre,validators:["required"]},{name:"fechacreacion",label:"Fecha de Creaci\xF3n",type:"datetime-local",value:e.fechacreacion,disabled:!0},{name:"fkemailusuario",label:"Usuario",type:"email",value:e.fkemailusuario,fk:!0,strTable:"usuario",validators:["required"]}]}),this.modal.openDynamicModal(t,i,this.Tabla).result.then(()=>this.TraerTabla()).catch(l=>console.error("Error en el modal:",l))}static \u0275fac=function(e){return new(e||r)(h(M),h(A))};static \u0275cmp=x({type:r,selectors:[["app-variable"]],decls:18,vars:3,consts:[[1,"container","mt-4"],[1,"mb-3"],["type","text","placeholder","Buscar indicador...",1,"form-control","mb-3",3,"ngModelChange","input","ngModel"],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[1,"table","table-hover"],[1,"table-dark"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-primary",3,"click"],["class","btn btn-sm btn-outline-primary me-1",3,"click",4,"ngIf"],["class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-outline-primary","me-1",3,"click"],[1,"bi","bi-pencil"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"h3",1),o(2,"Variables"),n(),a(3,"input",2),k("ngModelChange",function(l){return S(t.filtroTexto,l)||(t.filtroTexto=l),l}),u("input",function(){return t.filtrarTabla()}),n(),f(4,J,2,0,"button",3),a(5,"table",4)(6,"thead",5)(7,"tr")(8,"th"),o(9,"Acciones"),n(),a(10,"th"),o(11,"Nombre"),n(),a(12,"th"),o(13,"Fecha Creaci\xF3n"),n(),a(14,"th"),o(15,"Email Usuario"),n()()(),a(16,"tbody"),f(17,B,11,8,"tr",6),n()()()),e&2&&(m(3),T("ngModel",t.filtroTexto),m(),d("ngIf",t.roles.includes("admin")),m(13),d("ngForOf",t.dataFiltrada))},dependencies:[q,E,I,N,D,U,w],encapsulation:2})};export{O as VariableComponent};
