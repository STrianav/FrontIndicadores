import{a as w}from"./chunk-7GZO4EV5.js";import"./chunk-TNF5RKJF.js";import{a as I}from"./chunk-F6LDSNR5.js";import{a as F,c as D,g as M,o as q}from"./chunk-TGO5R4BE.js";import{h as V,i as E}from"./chunk-YSL4L367.js";import{Fb as n,Gb as m,Ib as C,Jb as T,Kb as S,Na as l,Ta as x,Xa as g,ab as v,d as k,ha as b,ia as f,kb as u,ob as i,pb as a,qb as h,r as y,tb as _,xb as p,yb as c}from"./chunk-RCD2EZCC.js";function A(o,r){if(o&1){let e=_();i(0,"button",8),p("click",function(){b(e);let d=c();return f(d.Crudd("C"))}),n(1,"Nuevo"),a()}}function O(o,r){if(o&1){let e=_();i(0,"button",11),p("click",function(){b(e);let d=c().$implicit,s=c();return f(s.Crudd("U",d))}),h(1,"i",12),a()}}function U(o,r){if(o&1){let e=_();i(0,"button",13),p("click",function(){b(e);let d=c().$implicit,s=c();return f(s.Crudd("D",d))}),h(1,"i",14),a()}}function J(o,r){if(o&1&&(i(0,"tr")(1,"td"),v(2,O,2,0,"button",9)(3,U,2,0,"button",10),a(),i(4,"td"),n(5),a(),i(6,"td"),n(7),a(),i(8,"td"),n(9),a(),i(10,"td"),n(11),a(),i(12,"td"),n(13),a()()),o&2){let e=r.$implicit,t=c();l(2),u("ngIf",t.roles.includes("admin")||t.roles.includes("Validador")),l(),u("ngIf",t.roles.includes("admin")),l(2),m(e.fkidvariable_descripcion),l(2),m(e.fkidindicador_descripcion),l(2),m(e.dato),l(2),m(e.fkemailusuario),l(2),m(e.fechadato)}}var N=class o{constructor(r,e){this.api=r;this.modal=e}data;Tabla="variablesporindicador";rolesJson=sessionStorage.getItem("roles");roles=[];filtroTexto="";dataFiltrada=[];ngOnInit(){this.TraerTabla(),this.roles=this.rolesJson?JSON.parse(this.rolesJson):[]}filtrarTabla(){let r=this.filtroTexto.toLowerCase();this.dataFiltrada=this.data.filter(e=>Object.values(e).some(t=>t?.toString().toLowerCase().includes(r)))}TraerTabla(){return k(this,null,function*(){try{this.data=yield y(this.api.TraerTabla(this.Tabla)),this.dataFiltrada=this.data}catch(r){console.error("Error al obtener la tabla:",r)}})}Crudd(r,e){let t;r==="C"?t={fields:[{name:"fkidvariable",label:"Variable",type:"text",fk:!0,value:"",strTable:"variable",validators:["required"]},{name:"fkidindicador",label:"Indicador",type:"text",fk:!0,value:"",strTable:"indicador",validators:["required"]},{name:"dato",label:"Dato",type:"text",value:"",validators:["required"]},{name:"fkemailusuario",label:"Email Usuario",type:"text",fk:!0,value:"",strTable:"usuario",validators:["required"]},{name:"fechadato",label:"Fecha Dato",type:"datetime-local",value:"",validators:["required"]}]}:r==="U"&&e?t={fields:[{name:"fkidvariable",label:"Variable",type:"text",fk:!0,value:e.fkidvariable,strTable:"variable",validators:["required"]},{name:"fkidindicador",label:"Indicador",type:"text",fk:!0,value:e.fkidindicador,strTable:"indicador",validators:["required"]},{name:"dato",label:"Dato",type:"text",value:e.dato,validators:["required"]},{name:"fkemailusuario",label:"Email Usuario",type:"text",fk:!0,value:e.fkemailusuario,strTable:"usuario",validators:["required"]},{name:"fechadato",label:"Fecha Dato",type:"datetime-local",value:e.fechadato,validators:["required"]}]}:r==="D"&&e&&(t={fields:[{name:"fkidvariable",label:"Variable",type:"text",fk:!0,value:e.fkidvariable,strTable:"variable",validators:[""]},{name:"fkidindicador",label:"Indicador",type:"text",fk:!0,value:e.fkidindicador,strTable:"indicador",validators:[""]},{name:"dato",label:"Dato",type:"text",value:e.dato,validators:[""]},{name:"fkemailusuario",label:"Email Usuario",type:"text",fk:!0,value:e.fkemailusuario,strTable:"usuario",validators:[""]},{name:"fechadato",label:"Fecha Dato",type:"datetime-local",value:e.fechadato,validators:[""]}]}),this.modal.openDynamicModal(t,r,this.Tabla).result.then(()=>{this.TraerTabla()})}static \u0275fac=function(e){return new(e||o)(x(I),x(w))};static \u0275cmp=g({type:o,selectors:[["app-variablesporindicador"]],decls:23,vars:3,consts:[[1,"container","mt-4"],[1,"mb-3"],["type","text","placeholder","Buscar indicador...",1,"form-control","mb-3",3,"ngModelChange","input","ngModel"],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[1,"table-responsive"],[1,"table","table-hover","custom-table"],[1,"table-dark"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-primary",3,"click"],["class","btn btn-sm btn-outline-primary me-1",3,"click",4,"ngIf"],["class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-outline-primary","me-1",3,"click"],[1,"bi","bi-pencil"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"h3",1),n(2,"Variables Por Indicador"),a(),i(3,"input",2),S("ngModelChange",function(s){return T(t.filtroTexto,s)||(t.filtroTexto=s),s}),p("input",function(){return t.filtrarTabla()}),a(),v(4,A,2,0,"button",3),i(5,"div",4)(6,"table",5)(7,"thead",6)(8,"tr")(9,"th"),n(10,"Acciones"),a(),i(11,"th"),n(12,"Variable"),a(),i(13,"th"),n(14,"Indicador"),a(),i(15,"th"),n(16,"Dato"),a(),i(17,"th"),n(18,"Email"),a(),i(19,"th"),n(20,"Fecha"),a()()(),i(21,"tbody"),v(22,J,14,7,"tr",7),a()()()()),e&2&&(l(3),C("ngModel",t.filtroTexto),l(),u("ngIf",t.roles.includes("admin")),l(18),u("ngForOf",t.dataFiltrada))},dependencies:[q,V,E,F,D,M],encapsulation:2})};export{N as VariablesporindicadorComponent};
