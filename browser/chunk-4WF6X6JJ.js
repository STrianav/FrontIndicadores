import{a as M}from"./chunk-7GZO4EV5.js";import"./chunk-TNF5RKJF.js";import{a as E}from"./chunk-F6LDSNR5.js";import{a as w,c as I,g as F,o as V}from"./chunk-TGO5R4BE.js";import{h as U,i as R}from"./chunk-YSL4L367.js";import{Fb as s,Gb as x,Ib as y,Jb as h,Kb as S,Na as l,Ta as g,Xa as T,ab as b,d as C,ha as p,ia as f,kb as c,ob as n,pb as r,qb as v,r as k,tb as _,xb as d,yb as u}from"./chunk-RCD2EZCC.js";function N(o,i){if(o&1){let e=_();n(0,"button",8),d("click",function(){p(e);let a=u();return f(a.Crudd("C"))}),s(1,"Nuevo"),r()}}function A(o,i){if(o&1){let e=_();n(0,"button",11),d("click",function(){p(e);let a=u().$implicit,m=u();return f(m.Crudd("U",a))}),v(1,"i",12),r()}}function O(o,i){if(o&1){let e=_();n(0,"button",13),d("click",function(){p(e);let a=u().$implicit,m=u();return f(m.Crudd("D",a))}),v(1,"i",14),r()}}function q(o,i){if(o&1&&(n(0,"tr")(1,"td"),b(2,A,2,0,"button",9)(3,O,2,0,"button",10),r(),n(4,"td"),s(5),r(),n(6,"td"),s(7),r()()),o&2){let e=i.$implicit,t=u();l(2),c("ngIf",t.roles.includes("admin")||t.roles.includes("Validador")),l(),c("ngIf",t.roles.includes("admin")),l(2),x(e.fkemail),l(2),x(e.fkidrol_descripcion)}}var D=class o{constructor(i,e){this.api=i;this.modal=e}data;Tabla="rol_usuario";rolesJson=sessionStorage.getItem("roles");roles=[];filtroTexto="";dataFiltrada=[];ngOnInit(){this.TraerTabla(),this.roles=this.rolesJson?JSON.parse(this.rolesJson):[]}filtrarTabla(){let i=this.filtroTexto.toLowerCase();this.dataFiltrada=this.data.filter(e=>Object.values(e).some(t=>t?.toString().toLowerCase().includes(i)))}TraerTabla(){return C(this,null,function*(){try{this.data=yield k(this.api.TraerTabla(this.Tabla)),this.dataFiltrada=this.data}catch(i){console.error("Error al obtener la tabla:",i)}})}Crudd(i,e){let t;i==="C"?t={fields:[{name:"fkidrol",label:"Rol",type:"text",fk:!0,value:"",strTable:"rol",validators:["required"]},{name:"fkemail",label:"Email Usuario",type:"text",fk:!0,value:"",strTable:"usuario",validators:["required"]}]}:i==="U"&&e?t={fields:[{name:"fkidrol",label:"Rol",type:"text",fk:!0,value:e.fkidrol,strTable:"rol",validators:["required"]},{name:"fkemail",label:"Email Usuario",type:"text",fk:!0,value:e.fkemail,strTable:"usuario",validators:["required"]}]}:i==="D"&&e&&(t={fields:[{name:"fkidrol",label:"Rol",type:"text",fk:!0,value:e.fkidrol,strTable:"rol",validators:[""]},{name:"fkemail",label:"Email Usuario",type:"text",fk:!0,value:e.fkemail,strTable:"usuario",validators:[""]}]}),this.modal.openDynamicModal(t,i,this.Tabla).result.then(()=>{this.TraerTabla()})}static \u0275fac=function(e){return new(e||o)(g(E),g(M))};static \u0275cmp=T({type:o,selectors:[["app-rol-usuario"]],decls:17,vars:3,consts:[[1,"container","mt-4"],[1,"mb-3"],["type","text","placeholder","Buscar indicador...",1,"form-control","mb-3",3,"ngModelChange","input","ngModel"],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[1,"table-responsive"],[1,"table","table-hover","custom-table"],[1,"table-dark"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-primary",3,"click"],["class","btn btn-sm btn-outline-primary me-1",3,"click",4,"ngIf"],["class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-outline-primary","me-1",3,"click"],[1,"bi","bi-pencil"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"h3",1),s(2,"Rol Usuario"),r(),n(3,"input",2),S("ngModelChange",function(m){return h(t.filtroTexto,m)||(t.filtroTexto=m),m}),d("input",function(){return t.filtrarTabla()}),r(),b(4,N,2,0,"button",3),n(5,"div",4)(6,"table",5)(7,"thead",6)(8,"tr")(9,"th"),s(10,"Acciones"),r(),n(11,"th"),s(12,"Usuario"),r(),n(13,"th"),s(14,"Rol"),r()()(),n(15,"tbody"),b(16,q,8,4,"tr",7),r()()()()),e&2&&(l(3),y("ngModel",t.filtroTexto),l(),c("ngIf",t.roles.includes("admin")),l(12),c("ngForOf",t.dataFiltrada))},dependencies:[V,U,R,w,I,F],encapsulation:2})};export{D as RolUsuarioComponent};
